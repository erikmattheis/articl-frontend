import{_ as z}from"./Zkd_L6hX.js";import{_ as G}from"./DdNZg7At.js";import{r as a,s as C,f as J,g as K,c as l,a as r,h as o,d as p,j as v,v as T,k as f,b as y,i as w,l as Q,m as W,t as X,w as Z,o as n}from"./nWBr_nlk.js";import{u as ss}from"./CxFU-RK6.js";import{u as es}from"./Cw_16z2z.js";import{u as os,a as as}from"./BneovxEs.js";import{u as ts}from"./CeXlfWiW.js";import{u as rs}from"./CZE8wajq.js";import{s as ls}from"./a1fnWWKB.js";const ns={key:0},ds={for:"oldPassword"},us={class:"toggle-password"},is=["type"],ps={key:0,for:"password"},ws={key:0,class:"left-space"},ms={class:"toggle-password"},cs=["type","aria-invalid"],gs={key:1,for:"password2"},vs={class:"toggle-password"},fs=["type","aria-invalid"],ys=["aria-busy","disabled"],hs={key:0},Ps={key:2,class:"invalid"},ks={key:1,class:"valid"},Us={__name:"change-password-logged-in",setup(_s){const m=a(null),d=a(null),u=a(null),h=a("password"),P=a("password"),k=a("password"),i=a(!1),M=a(0),c=a(""),_=a(!1),b=a(null);a(0);const g=a("");a(!1);const N=ss(),I=os(),U=ts(),D=as(),E=rs(),{setError:V}=I,{user:L,isLoggedIn:bs}=C(U),{accessTokenValue:x}=C(D),{setSuccessTitle:F,setSuccessMessage:Y}=E,{isLoggedInMixin:B}=es();J(d,e=>{M.value=ls(e)}),K(()=>{var e;g.value=(e=L.value)==null?void 0:e.username});const O=()=>{var s;let e=!0;return((s=d.value)==null?void 0:s.length)<8?(c.value="Passwords are at least eight characters.",e=!1):d.value!==u.value?(c.value="Passwords do not mach.",e=!1):x.value||(c.value="You are must be logged in to use this form.",e=!1),e},R=()=>{_.value=null,b.value=null},$=async()=>{try{R(),O()?(i.value=!0,await N({method:"POST",url:"/auth/change-password-logged-in",data:{token:x.value,oldPassword:m.value,password:d.value,password2:u.value}}),F("Password updated"),Y("You have successfully changed your password."),_.value=!0):V(c.value)}catch(e){V(e)}finally{i.value=!1}},j=()=>{h.value=h.value==="password"?"text":"password"},A=()=>{P.value=P.value==="password"?"text":"password"},H=()=>{k.value=k.value==="password"?"text":"password"};return(e,s)=>{const S=z,q=G;return n(),l("article",null,[s[12]||(s[12]=r("h1",null,"Change Password",-1)),o(_)?(n(),l("p",ks,[s[11]||(s[11]=p(" You have successfully changed your password. Please ")),y(q,{to:"/login"},{default:Z(()=>s[10]||(s[10]=[p("sign in with your new password ")])),_:1})])):(n(),l("form",ns,[r("label",ds,[s[7]||(s[7]=p("Current Password ")),r("div",us,[v(r("input",{id:"oldPassword","onUpdate:modelValue":s[0]||(s[0]=t=>f(m)?m.value=t:null),name:"oldPassword",type:o(h),autocomplete:"current-password"},null,8,is),[[T,o(m)]]),y(S,{class:"toggle-password-mask",onShow:j})])]),o(B)?w("",!0):(n(),l("label",ps,[s[8]||(s[8]=p("New Password ")),e.passwordInvalid?(n(),l("small",ws," Must be 12 or more characters using characters from at least two of these groups: uppercase letters, lowercase letters, digits, and special characters. ")):w("",!0),r("div",ms,[v(r("input",{id:"password","onUpdate:modelValue":s[1]||(s[1]=t=>f(d)?d.value=t:null),type:o(P),"aria-invalid":e.passwordInvalid,maxlength:"64",name:"password",autocomplete:"new-password",onBlur:s[2]||(s[2]=(...t)=>e.elementBlurred&&e.elementBlurred(...t))},null,40,cs),[[T,o(d)]]),y(S,{class:"toggle-password-mask",onShow:A})])])),o(B)?w("",!0):(n(),l("label",gs,[s[9]||(s[9]=p("Confirm New Password ")),r("div",vs,[v(r("input",{id:"password2","onUpdate:modelValue":s[3]||(s[3]=t=>f(u)?u.value=t:null),type:o(k),maxlength:"64",name:"password2","aria-invalid":e.password2Invalid,autocomplete:"new-password",onBlur:s[4]||(s[4]=(...t)=>e.elementBlurred&&e.elementBlurred(...t))},null,40,fs),[[T,o(u)]]),y(S,{class:"toggle-password-mask",onShow:H})])])),v(r("input",{type:"hidden",name:"username","onUpdate:modelValue":s[5]||(s[5]=t=>f(g)?g.value=t:null),autocomplete:"username"},null,512),[[Q,o(g)]]),r("button",{id:"reset",type:"submit","aria-busy":o(i),disabled:o(i),onClick:s[6]||(s[6]=W(t=>$(),["prevent"]))},[o(i)?w("",!0):(n(),l("span",hs,"Change Password"))],8,ys),o(b)?(n(),l("p",Ps,X(o(b)),1)):w("",!0)]))])}}};export{Us as default};
