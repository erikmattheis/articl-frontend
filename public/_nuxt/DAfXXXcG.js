import{_ as N}from"./C3Ixn-cu.js";import{n as $,o as i,c as _,b as n,w as y,a as S,s as L,H as W,d as X,t as Y,h as f,I as A,i as Z,_ as D,u as q,r as u,g as z,Q as ee,R as te,F as ae,J as re}from"./CZZvAiAY.js";import{u as oe}from"./Y8PKdVdW.js";import{u as se}from"./74KAbxKp.js";import{u as U}from"./DMjj82qv.js";import{u as ce}from"./CUy4Dzmh.js";import{u as ne}from"./BVRFDUUq.js";const le={class:"row-admin-box box"},ue={role:"button",class:"handle",href:"#"},ie={__name:"HomeCategoryActions",props:{id:{type:String,default:""},slug:{type:String,default:""}},setup(a){return(o,s)=>{const c=$("vue-feather"),r=N;return i(),_("div",le,[n(r,{to:{name:"resource-categories",query:{id:a.id}},role:"button"},{default:y(()=>[n(c,{size:"0.7rem",type:"edit","aria-label":"Edit category"})]),_:1},8,["to"]),n(r,{to:{name:"resource-categories-delete",query:{id:a.id,slug:a.slug},params:{slug:a.slug}},role:"button"},{default:y(()=>[n(c,{size:"0.7rem",type:"delete","aria-label":"Delete category"})]),_:1},8,["to"]),S("a",ue,[s[0]||(s[0]=S("div",{class:"sr"},"Reorder category",-1)),n(c,{size:"0.7rem",type:"move","aria-label":"Drag to reorder"})])])}}},de={class:"container"},ge={__name:"HomeCategoriesListItem",props:{category:{type:Object,default:{}}},setup(a){const{isLoggedInMixin:o}=oe(),s=U(),c=se();L(c);const{breadcrumbs:r}=L(s),g=W(()=>r.value.length!==3?"resource-slug":"resource-slug-articls");return(d,j)=>{const m=N,b=ie;return i(),_("div",de,[n(m,{to:{name:f(g),params:{slug:a.category.slug||0}},class:"box"},{default:y(()=>[X(Y(a.category.title),1)]),_:1},8,["to"]),f(o)?(i(),A(b,{key:0,id:a.category.id,class:"box",slug:a.category.slug||"0"},null,8,["id","slug"])):Z("",!0)])}}},me={__name:"CoreButtonNewCategory",setup(a){const o=q(),s=u(null);return z(()=>{s.value=o.params.slug}),(c,r)=>{const g=N;return i(),A(g,{to:{name:"resource-categories",query:{parentSlug:f(s)||"0"}}},{default:y(()=>r[0]||(r[0]=[S("button",{class:"bright-button"},"New Category Here",-1)])),_:1},8,["to"])}}},pe=D(me,[["__scopeId","data-v-2b1018c8"]]),_e={__name:"HomeCategoriesList",setup(a){const o=u(!1);u({}),u("");const s=u(""),c=u("");u(null);const r=U(),g=ne(),{categories:d,breadcrumbs:j}=L(r),{setCategories:m,setBreadcrumbs:b,setArticls:T,setNotes:k,setSlug:H,setArticlType:w,setHtmlTitle:F}=r,{setError:v}=g,C=q(),B=ce();z(()=>{I(C.params.slug),H(C.params.slug),w(C.params.articlType)}),ee((e,t)=>{R(e,t)}),te((e,t)=>{R(e,t)});const R=(e,t)=>{e.params.articlType!==t.params.articlType&&w(e.params.articlType),e.params.slug!==t.params.slug&&(H(e.params.slug),I(e.params.slug))},I=async e=>{try{o.value=!0;const t=await M(e);G(t)}catch(t){v(t)}finally{o.value=!1}},M=async e=>{const t=await B({method:"GET",url:`/resource/${e||""}`}),l=t.articls?Object.keys(t.data.articls):[];return{breadcrumbs:t.data.breadcrumbs,categories:t.data.categories,category:t.data.category,articlTypes:l,articls:t.data.articls,notes:t.data.notes}},G=async e=>{var t,l,h,x,p,V,O;try{(t=e.categories)!=null&&t.length?m(e.categories):m([]),(l=e.breadcrumbs)!=null&&l.length?b(e.breadcrumbs):b([]),(h=e.articls)!=null&&h.length?T(e.articls):T([]),(x=e.notes)!=null&&x.length?k(e.notes):k([]),s.value=(p=e.category[0])==null?void 0:p.title,c.value=(V=e.category[0])==null?void 0:V.titleHtml;const E=(O=e.category[0])==null?void 0:O.description;F(c.value)}catch(E){v(E)}},J=()=>{try{d.value.forEach((e,t)=>{const l=e;l.order=t}),m(d.value)}catch(e){v(e)}},P=()=>{try{const e=d.value.map(t=>({id:t.id,order:t.order}));Q(e)}catch(e){v(e)}},Q=async e=>{o.value=!0;const t=await B({method:"POST",url:"/categories/order",data:{order:e}});return o.value=!1,t.data},K=()=>{J(),P()};return(e,t)=>{const l=ge,h=$("draggable"),x=pe;return i(),_("div",null,[n(h,{list:f(d),tag:"ul","item-key":"id",handle:".handle","ghost-class":"ghost",onChange:K},{default:y(()=>[(i(!0),_(ae,null,re(f(d),p=>(i(),_("div",{key:p.id},[n(l,{category:p,class:"list-item","tree-level":e.treeLevel},null,8,["category","tree-level"])]))),128))]),_:1},8,["list"]),n(x)])}}},Se=D(_e,[["__scopeId","data-v-277852f6"]]);export{Se as _};
