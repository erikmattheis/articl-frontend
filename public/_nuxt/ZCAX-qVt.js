import{r as e,u as q,e as L,g as V,c as _,a as u,t as g,h as t,m as E,i as A,o as k,x as G}from"./nWBr_nlk.js";import{u as j}from"./CxFU-RK6.js";import{u as z}from"./BneovxEs.js";import{u as F}from"./CZE8wajq.js";const H=["aria-busy"],I=["aria-busy"],U={__name:"delete",setup(J){const y=e(!1),l=e(!1),D=e([]),T=e([]),c=e(""),i=e(""),x=e(""),m=e(""),p=e(""),f=q(),w=L(),h=j(),$=z(),B=F(),{setError:v}=$,{setSuccessMessage:b}=B;V(()=>{p.value=f.query.id,i.value=f.query.slug,N(i.value)});const M=async r=>h({method:"GET",url:`/resource/${r}`}),N=async r=>{var a,s,o,d,C,S;try{l.value=!0;const n=await M(r);c.value=((s=(a=n.data)==null?void 0:a.category[0])==null?void 0:s.title)||"",x.value=((d=(o=n.data)==null?void 0:o.articls)==null?void 0:d.length)||0,m.value=((S=(C=n.data)==null?void 0:C.category[0])==null?void 0:S.parentSlug)||"",l.value=!1}catch(n){v(n)}},R=async()=>{try{l.value=!0,await h({method:"DELETE",url:`/categories/${p.value}`}),b("Deletion successful."),b(`The category "${c.value}" has been permanently deleted.`),G("/")}catch(r){v(r)}finally{l.value=!1}};return(r,a)=>{var s,o;return k(),_("article",null,[a[1]||(a[1]=u("h1",null,"Delete Category",-1)),u("p",null,'Really delete "'+g(t(c))+'"? This will permanently delete the category and make child categories and articls permanently unreachable. There are '+g((s=t(D))==null?void 0:s.length)+" descendant categories and "+g((o=t(T))==null?void 0:o.length)+" articls. ",1),u("form",null,[u("button",{type:"button","aria-busy":t(y),onClick:a[0]||(a[0]=E(d=>t(w).push({name:"resource-slug",params:{slug:t(m)}}),["prevent"]))}," Cancel ",8,H),t(i)?(k(),_("button",{key:0,type:"button","aria-busy":t(y),onClick:E(R,["prevent"])}," Delete ",8,I)):A("",!0)])])}}};export{U as default};
