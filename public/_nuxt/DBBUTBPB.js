import{V as c,s as u}from"./Bra6A4mU.js";import{u as g,a as f}from"./C8YHhs51.js";import{a as t}from"./Dr10A1eW.js";const l=e=>{const r=JSON.parse(JSON.stringify(e));return r.access.token=e.access.token,r.access.expires=Date.parse(e.access.expires),r.refresh.token=e.refresh.token,r.refresh.expires=Date.parse(e.refresh.expires),r},k=c("user",{state:()=>({isEmailVerified:void 0,user:void 0,logInError:void 0,isLoggedIn:!1}),actions:{async setUser(e){this.user=JSON.stringify(e)},async login({username:e,password:r}){try{const o=await g({username:e,password:r}),{data:s}=o;if(s.error)return this.logInError=`${s.error}`,!1;if(s&&s.user){this.user=s.user,this.isLoggedIn=!0;const n=l(s.tokens),a=t(),{setTokens:i}=a;i(n)}return!0}catch(o){return this.logInError=o.message||"Unknown error",!1}},async logout(){try{const e=t(),{clearTokens:r}=e,{accessTokenValue:o}=u(e);await f(o.value),r(),this.user=null,this.isLoggedIn=!1}catch(e){console.error("Logout error:",e.message||"Unknown error")}},clearLogInError(){this.logInError=""}},persist:!0,getters:{}});export{k as u};
