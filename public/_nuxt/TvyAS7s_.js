import{_ as ie,n as ce,o as n,c as r,a as u,b as j,t as h,r as a,u as de,e as ve,H as V,g as pe,h as s,F,d as S,j as k,l as E,k as C,J as me,i as N,m as B,E as ge,T as fe,x as ye}from"./BI3g6Nse.js";import{u as _e}from"./Dl_VRi8j.js";import{u as be}from"./CdQJ6MTo.js";import{u as Ie}from"./CpJUWWxd.js";const Se={class:"tab",title:"success"},ke={class:"info"},Ce={__name:"CoreCardNotification",props:{successMessage:{type:String,default:""}},setup(L){return(c,v)=>{const A=ce("vue-feather");return n(),r("section",null,[u("div",Se,[j(A,{size:"60",type:"check","aria-label":"Check mark"})]),u("div",ke,[u("aside",null,h(L.successMessage),1)])])}}},he=ie(Ce,[["__scopeId","data-v-b66917c4"]]),Ae={key:0},xe={key:1},Te={key:0},De={for:"title"},Me={for:"titleHtml"},Ee={for:"selectedAIDescriptionIndex"},we=["value"],He=["disabled","aria-busy"],Ve={key:0},$e={for:"description"},Pe={for:"slug"},Ue={for:"parentSlug"},Fe=["aria-busy"],Ne={key:0},Ke={__name:"index",setup(L){const c=a(null),v=a(!1),A=a("Get AI Summaries");a([]);const y=a([]),o=a(null),x=a(null),g=a(""),$=a(""),_=a(null),z=a(0),i=a(0);a(null);const T=a(!1),p=a(null),d=a(null),w=a(null),J=a(null),Q=a(null),W=a(null),X=a(null),Y=a(null),R=a([]),Z=be(),ee=Ie(),{setError:H}=Z,{setSuccessTitle:te,setSuccessMessage:ae}=ee,G=de(),K=ve(),P=_e(),U=V(()=>v.value||_.value),q=V(()=>p.value||d.value),f=V({get(){let t=d.value;return t?(t=t.replace(/\s/g,"-"),t=t.toLowerCase(),t=encodeURI(t),t=t.replace(/'/g,"%27"),t):""},set(t){return t}}),D=V({get(){return o.value!==null&&y.value[o.value]?y.value[o.value].message.content:w.value},set(t){o.value!==null&&y.value[o.value]?y.value[o.value].message.content=t:w.value=t}});pe(()=>{c.value=G.query.id,i.value=G.query.parentSlug,$.value=c.value?"Edit":"Create",c.value&&oe(c.value)});const se=()=>{T.value=!1,g.value="",x.value=""},le=()=>{se();let t=!0;return p.value?d.value?f.value?i.value?w.value||(J.value=!0,g.value="Please select or enter a description.",t=!1):(Y.value=!0,g.value="Please select a parent category.",t=!1):(X.value=!0,g.value="Please enter a slug.",t=!1):(W.value=!0,g.value="Please enter a HTML title.",t=!1):(Q.value=!0,g.value="Please enter a title.",t=!1),t},ue=async()=>{var t,e,b,l,M;try{v.value=!0,x.value="";const I={category:q.value,parentCategory:((t=R.value[R.value.length-2])==null?void 0:t.title)||""},m=await P({method:"POST",url:"/categories/ai-summary",data:I});((e=m.data)==null?void 0:e.status)===200&&Array.isArray((b=m.data)==null?void 0:b.message)?(y.value.push(...m.data.message),o.value=0,A.value="Get More AI Summaries"):(l=m.data)!=null&&l.message?x.value=`Error status ${(M=m.data)==null?void 0:M.status}: ${m.data.message}`:x.value="There was an unknown error generating AI summaries."}catch(I){H(I)}finally{v.value=!1}},oe=async t=>{try{_.value=!0;const e=await P({method:"GET",url:`/categories/${t}`});e&&e.data&&(w.value=e.data.description,o.value=0,A.value="Get More AI Summaries",i.value=e.data.parentSlug,p.value=e.data.title,d.value=e.data.titleHtml||e.data.title,z.value=f.value=e.data.slug)}catch(e){H(e)}finally{_.value=!1}},ne=()=>{p.value="",d.value="",f.value="",D.value="",i.value=0},re=async()=>{try{if(le()){_.value=!0,v.value=!0;const t=c.value?"PUT":"POST",e=c.value||"",b={title:p.value,titleHtml:d.value,slug:f.value,description:D.value,parentSlug:i.value};await P({method:t,url:`/categories/${e}`,data:b});const l=c.value?"Edited":"Created";T.value=!0,te(`Category ${l}`),ae(`The category was successfully ${l}.`),parseInt(i.value)===0?K.push("/"):K.push({name:"resource-slug",params:{slug:i.value}}),ne()}else H(g.value)}catch(t){H(t)}finally{_.value=!1,v.value=!1}},O=()=>{ye("/resource/categories"),T.value=!1};return(t,e)=>{const b=he;return n(),r("article",null,[s(T)?(n(),r("h1",xe," Success ")):(n(),r("h1",Ae,h(s($))+" category ",1)),s(_)?N("",!0):(n(),r(F,{key:2},[s(T)?(n(),r(F,{key:1},[j(b,{"success-message":"Category created."}),u("a",{href:"",onClick:B(O,["prevent"]),onKeyup:ge(O,["enter"])},"Create another category",32)],64)):(n(),r("form",Te,[u("label",De,[e[8]||(e[8]=S("Title ")),k(u("input",{id:"title","onUpdate:modelValue":e[0]||(e[0]=l=>C(p)?p.value=l:null),type:"text",name:"title"},null,512),[[E,s(p)]])]),u("label",Me,[e[9]||(e[9]=S("HTML Title ")),k(u("input",{id:"titleHtml","onUpdate:modelValue":e[1]||(e[1]=l=>C(d)?d.value=l:null),type:"text",name:"titleHtml"},null,512),[[E,s(d)]])]),(n(!0),r(F,null,me(s(y),(l,M)=>{var I;return n(),r("div",{key:M},[u("label",Ee,[k(u("input",{type:"radio",name:"selectedAIDescriptionIndex",id:"selectedAIDescriptionIndex",value:M,"onUpdate:modelValue":e[2]||(e[2]=m=>C(o)?o.value=m:null)},null,8,we),[[fe,s(o)]]),S(" "+h((I=l.message)==null?void 0:I.content),1)])])}),128)),u("p",null,h(s(x)),1),u("button",{type:"button",disabled:!s(q)||s(U),"aria-busy":s(U),onClick:B(ue,["prevent"])},[s(U)?N("",!0):(n(),r("span",Ve,h(s(A)),1))],8,He),u("label",$e,[e[10]||(e[10]=S("Description ")),k(u("textarea",{id:"description","onUpdate:modelValue":e[3]||(e[3]=l=>C(D)?D.value=l:null),name:"description",rows:"10",cols:"70",onKeyup:e[4]||(e[4]=(...l)=>t.editAIDescription&&t.editAIDescription(...l))},null,544),[[E,s(D)]])]),u("label",Pe,[e[11]||(e[11]=S("Slug ")),k(u("input",{id:"slug","onUpdate:modelValue":e[5]||(e[5]=l=>C(f)?f.value=l:null),type:"text",name:"slug"},null,512),[[E,s(f)]])]),u("label",Ue,[e[12]||(e[12]=S("Parent slug ")),k(u("input",{id:"parentSlug","onUpdate:modelValue":e[6]||(e[6]=l=>C(i)?i.value=l:null),type:"text",name:"parentSlug"},null,512),[[E,s(i)]])]),u("button",{type:"submit","aria-busy":s(v),onClick:e[7]||(e[7]=B(l=>re(s(c)),["prevent"]))},[s(v)?N("",!0):(n(),r("span",Ne,h(s($))+" category",1))],8,Fe)]))],64))])}}};export{Ke as default};
